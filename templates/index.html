<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jellyfin å½±ç‰‡ç®¡ç†</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="app">
        <!-- RSS/JavDB Notification Toast -->
        <div v-if="rssNotification.show" class="rss-notification" :class="rssNotification.type === 'javdb' ? 'javdb-notification' : ''" @click="showNotificationDetails">
            <div class="rss-notification-icon">[[ rssNotification.type === 'javdb' ? 'â­' : 'ğŸ“¡' ]]</div>
            <div class="rss-notification-content">
                <div class="rss-notification-title">[[ rssNotification.type === 'javdb' ? 'JavDB è¯„åˆ†è·å–' : 'RSS è®¢é˜…å®Œæˆ' ]]</div>
                <div class="rss-notification-summary" v-if="rssNotification.message">
                    [[ rssNotification.message ]]
                </div>
                <div class="rss-notification-summary" v-else>
                    æˆåŠŸ: [[ rssNotification.success ]] | å¤±è´¥: [[ rssNotification.fail ]]
                </div>
            </div>
            <button class="rss-notification-close" @click.stop="dismissRssNotification">Ã—</button>
        </div>

        <!-- RSS/JavDB Details Modal -->
        <div v-if="rssDetailsModal.show" class="modal-overlay" @click="rssDetailsModal.show = false">
            <div class="modal-content rss-details-modal" @click.stop>
                <div class="modal-header">
                    <h2>[[ rssDetailsModal.title || 'RSS è®¢é˜…è¯¦æƒ…' ]]</h2>
                    <button class="modal-close" @click="rssDetailsModal.show = false">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="rss-details-summary">
                        <div class="rss-summary-item success">
                            <span class="rss-summary-count">[[ rssDetailsModal.summary?.success || 0 ]]</span>
                            <span class="rss-summary-label">æˆåŠŸ</span>
                        </div>
                        <div class="rss-summary-item fail">
                            <span class="rss-summary-count">[[ rssDetailsModal.summary?.fail || 0 ]]</span>
                            <span class="rss-summary-label">å¤±è´¥</span>
                        </div>
                        <div class="rss-summary-item total">
                            <span class="rss-summary-count">[[ rssDetailsModal.summary?.total || 0 ]]</span>
                            <span class="rss-summary-label">æ€»è®¡</span>
                        </div>
                    </div>
                    <div v-if="rssDetailsModal.results && rssDetailsModal.results.length > 0" class="rss-details-list">
                        <!-- JavDB Results -->
                        <div v-if="rssDetailsModal.title && rssDetailsModal.title.includes('JavDB')" class="rss-details-section">
                            <h3>è¯„åˆ†ç»“æœ</h3>
                            <div v-for="item in rssDetailsModal.results.slice(-20).reverse()" :key="item.code || item.task_id" class="rss-detail-item" :class="item.status === 'success' ? 'success-item' : 'fail-item'">
                                <span class="rss-detail-name">[[ item.code ]]</span>
                                <span v-if="item.score" class="rss-detail-score">â­ [[ item.score ]]/5</span>
                                <span v-else class="rss-detail-error">[[ item.status === 'not_found' ? 'æœªæ‰¾åˆ°' : (item.error || 'å¤±è´¥') ]]</span>
                            </div>
                        </div>
                        <!-- RSS Results -->
                        <div v-else class="rss-details-section">
                            <h3>å¤±è´¥è¯¦æƒ…</h3>
                            <div v-for="item in rssDetailsModal.results.filter(r => !r.success)" :key="item.actor_id" class="rss-detail-item fail-item">
                                <span class="rss-detail-name">[[ item.actor_name ]]</span>
                                <span class="rss-detail-error">[[ item.error ]]</span>
                            </div>
                            <div v-if="rssDetailsModal.results.filter(r => !r.success).length === 0" class="rss-detail-empty">
                                æ‰€æœ‰æ¼”å‘˜æ›´æ–°æˆåŠŸï¼
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Header -->
        <header>
            <h1>Jellyfin Movies</h1>
            <div class="header-actions">
                <div v-if="rssRefreshing" class="rss-status-indicator">
                    <span class="rss-spinner"></span>
                    <span>RSS æ›´æ–°ä¸­...</span>
                </div>
                <button @click="sync" :disabled="syncing" class="sync-btn">
                    <span v-if="syncing">åŒæ­¥ä¸­...</span>
                    <span v-else>ğŸ”„ åŒæ­¥</span>
                </button>
                <button @click="calcScores" :disabled="calculating" class="sync-btn score-btn">
                    <span v-if="calculating">è®¡ç®—ä¸­...</span>
                    <span v-else>ğŸ“Š è®¡ç®—æƒé‡åˆ†</span>
                </button>
                <button @click="fetchJavdbScores" :disabled="javdbFetching" class="sync-btn javdb-btn">
                    <span v-if="javdbFetching">è·å–ä¸­...</span>
                    <span v-else>â­ JavDBè¯„åˆ†</span>
                </button>
                <span class="stats">å…± [[ stats.total ]] éƒ¨å½±ç‰‡</span>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <h2>Jellyfin å½±ç‰‡åº“</h2>
                <p>ç®¡ç†æ‚¨çš„ç§äººå½±ç‰‡æ”¶è—ï¼Œæ¢ç´¢ JavDB å’Œ JavLibray æ¦œå•</p>
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="number">[[ stats.total ]]</div>
                        <div class="label">éƒ¨å½±ç‰‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">[[ stats.javdb_count || 0 ]]</div>
                        <div class="label">JavDB TOP250</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">[[ stats.javlib_count || 0 ]]</div>
                        <div class="label">JavLibrary TOP500</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Tabs -->
            <div class="tabs">
                <button
                    v-for="tab in tabs"
                    :key="tab.id"
                    :class="['tab', { active: currentTab === tab.id }]"
                    @click="switchTab(tab.id)"
                >
                    [[ tab.icon ]] [[ tab.name ]]
                </button>
            </div>

            <!-- Search Bar -->
            <div class="search-bar" v-if="currentTab === 'all' || currentTab.startsWith('actor_')">
                <div class="search-wrapper">
                    <input
                        type="text"
                        v-model="search"
                        placeholder="æœç´¢ç•ªå·æˆ–æ¼”å‘˜..."
                        @input="handleSearch"
                    >
                </div>
                <select v-model="sortBy" @change="handleSearch" class="sort-select">
                    <option value="code">æŒ‰ç•ªå·æ’åº</option>
                    <option value="year_desc">æŒ‰å¹´ä»½(æ–°â†’æ—§)</option>
                    <option value="year_asc">æŒ‰å¹´ä»½(æ—§â†’æ–°)</option>
                    <option value="score_desc">æŒ‰æƒé‡åˆ†(é«˜â†’ä½)</option>
                    <option value="score_asc">æŒ‰æƒé‡åˆ†(ä½â†’é«˜)</option>
                </select>
            </div>

            <!-- Movie Cards Grid (All Movies) -->
            <div v-if="currentTab === 'all'" class="movie-list">
                <div class="section-title">å…¨éƒ¨å½±ç‰‡</div>

                <!-- Movie Cards Grid -->
                <div class="movie-grid">
                    <div v-for="movie in movies" :key="movie.code" class="movie-card">
                        <div class="movie-poster">
                            <img v-if="movie.poster_url" :src="movie.poster_url" :alt="movie.title" @error="handlePosterError($event)">
                            <svg v-else class="placeholder-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"/>
                            </svg>
                        </div>
                        <div class="movie-info">
                            <div class="movie-code">[[ movie.code ]]</div>
                            <div class="movie-title" :title="movie.title">[[ movie.title ]]</div>
                            <div class="movie-year">[[ movie.year ]]</div>
                            <div class="movie-actors" v-if="movie.actors">[[ movie.actors ]]</div>
                            <div class="movie-score" v-if="movie.score">[[ movie.score ]]åˆ†</div>
                            <div class="movie-javdb-score" v-if="movie.javdb_score" :class="getJavdbScoreClass(movie.javdb_score)">
                                â­ [[ movie.javdb_score ]]/5
                            </div>
                            <div v-else>
                                <button class="fetch-javdb-btn" @click="fetchJavdbScore(movie)" :disabled="movie.fetching">
                                    [[ movie.fetching ? 'è·å–ä¸­...' : 'è·å–JavDBè¯„åˆ†' ]]
                                </button>
                            </div>
                            <div class="movie-tags">
                                <span
                                    v-for="tag in movie.all_tags"
                                    :key="tag"
                                    :class="['movie-tag', movie.tags.includes(tag) ? 'active' : 'inactive']"
                                >
                                    [[ getShortTag(tag) ]]
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="movies.length === 0" class="empty">æš‚æ— æ•°æ®</div>

                <!-- Pagination -->
                <div class="pagination" v-if="totalPages > 1">
                    <button @click="goToPage(1)" :disabled="currentPage === 1">é¦–é¡µ</button>
                    <button @click="goToPage(currentPage - 1)" :disabled="currentPage === 1">ä¸Šä¸€é¡µ</button>
                    <span class="page-info">ç¬¬ [[ currentPage ]] / [[ totalPages ]] é¡µ (å…± [[ totalItems ]] æ¡)</span>
                    <button @click="goToPage(currentPage + 1)" :disabled="currentPage === totalPages">ä¸‹ä¸€é¡µ</button>
                    <button @click="goToPage(totalPages)" :disabled="currentPage === totalPages">æœ«é¡µ</button>
                    <select v-model="pageSize" @change="changePageSize(pageSize)" class="sort-select" style="padding: 8px 16px;">
                        <option :value="50">50æ¡/é¡µ</option>
                        <option :value="100">100æ¡/é¡µ</option>
                    </select>
                </div>
            </div>

            <!-- Rank Tables -->
            <div v-else-if="currentTab.startsWith('javdb') || currentTab === 'javlib'" class="rank-section">
                <div class="section-title">[[ getTabTitle(currentTab) ]]</div>

                <div class="rank-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ç•ªå·</th>
                                <th>æ ‡é¢˜</th>
                                <th>å¹´ä»½</th>
                                <th>æ¼”å‘˜</th>
                                <th>æ”¶å½•çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="movie in listMovies" :key="movie.code" :class="{ 'not-in-jellyfin': !movie.in_jellyfin }">
                                <td class="rank">[[ movie.rank ]]</td>
                                <td class="code">
                                    <a :href="'https://www.javbus.com/' + movie.code" target="_blank" class="javbus-link">[[ movie.code ]]</a>
                                </td>
                                <td class="title">[[ movie.title || '-' ]]</td>
                                <td>[[ movie.year ]]</td>
                                <td class="actors">[[ movie.actors ]]</td>
                                <td>
                                    <span :class="['status-badge', movie.in_jellyfin ? 'yes' : 'no']">
                                        <span v-if="movie.in_jellyfin">âœ“</span>
                                        <span v-else>âœ—</span>
                                        [[ movie.in_jellyfin ? 'å·²æ”¶å½•' : 'æœªæ”¶å½•' ]]
                                    </span>
                                    <a v-if="!movie.in_jellyfin" :href="'https://www.javbus.com/' + movie.code" target="_blank" class="javbus-btn">JavBus</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pagination" v-if="totalPages > 1">
                    <button @click="goToPage(1)" :disabled="currentPage === 1">é¦–é¡µ</button>
                    <button @click="goToPage(currentPage - 1)" :disabled="currentPage === 1">ä¸Šä¸€é¡µ</button>
                    <span class="page-info">ç¬¬ [[ currentPage ]] / [[ totalPages ]] é¡µ (å…± [[ totalItems ]] æ¡)</span>
                    <button @click="goToPage(currentPage + 1)" :disabled="currentPage === totalPages">ä¸‹ä¸€é¡µ</button>
                    <button @click="goToPage(totalPages)" :disabled="currentPage === totalPages">æœ«é¡µ</button>
                    <select v-model="pageSize" @change="changePageSize(pageSize)" class="sort-select" style="padding: 8px 16px;">
                        <option :value="50">50æ¡/é¡µ</option>
                        <option :value="100">100æ¡/é¡µ</option>
                    </select>
                </div>
            </div>

            <!-- Missing View -->
            <div v-else-if="currentTab === 'missing'" class="missing-view">
                <div v-if="missing.both && missing.both.length > 0" class="missing-section both-section">
                    <h2>âš ï¸ ä¸¤æ¦œå•å‡æœªæ”¶å½• ([[ missing.both.length ]])</h2>
                    <div class="code-list">
                        <span v-for="code in missing.both" :key="code" class="code-item code-item-both">
                            <a :href="'https://www.javbus.com/' + code" target="_blank" class="javbus-link">[[ code ]]</a>
                        </span>
                    </div>
                </div>

                <div class="missing-tables">
                    <div class="missing-section">
                        <h2>JavDB TOP250 æœªæ”¶å½• ([[ missing.javdb ? missing.javdb.length : 0 ]])</h2>
                        <div class="rank-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ç•ªå·</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in missing.javdb" :key="item.code" :class="{ 'in-both': missing.both && missing.both.includes(item.code) }">
                                        <td class="rank">[[ item.rank ]]</td>
                                        <td class="code">
                                            <a :href="'https://www.javbus.com/' + item.code" target="_blank" class="javbus-link">[[ item.code ]]</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="missing-section">
                        <h2>JavLibray TOP500 æœªæ”¶å½• ([[ missing.javlib ? missing.javlib.length : 0 ]])</h2>
                        <div class="rank-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ç•ªå·</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in missing.javlib" :key="item.code" :class="{ 'in-both': missing.both && missing.both.includes(item.code) }">
                                        <td class="rank">[[ item.rank ]]</td>
                                        <td class="code">
                                            <a :href="'https://www.javbus.com/' + item.code" target="_blank" class="javbus-link">[[ item.code ]]</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actors List -->
            <div v-else-if="currentTab === 'actors'" class="actors-view">
                <div class="section-title">æ¼”å‘˜åˆ—è¡¨</div>
                <div class="actor-list">
                    <div
                        v-for="actor in actors"
                        :key="actor.name"
                        :class="['actor-item', { 'has-javbus': rssActors[actor.name] && rssActors[actor.name].javbus_id }]"
                        @click="showActorDetail(actor.name)"
                    >
                        <span class="actor-name">[[ actor.name ]]</span>
                        <span class="actor-count">[[ actor.count ]] éƒ¨</span>
                        <span v-if="rssActors[actor.name] && rssActors[actor.name].javbus_id" class="javbus-badge">ğŸ“¡</span>
                    </div>
                </div>
            </div>

            <!-- Actor Detail Page -->
            <div v-else-if="currentTab.startsWith('actor_')" class="actor-detail-page">
                <!-- Back button and header -->
                <button class="back-btn" @click="currentTab = 'actors'; loadActors()">â† è¿”å›æ¼”å‘˜åˆ—è¡¨</button>

                <!-- Actor Profile -->
                <div class="actor-profile">
                    <div class="actor-avatar">
                        <img v-if="actorDetail.avatar_url" :src="actorDetail.avatar_url" :alt="actorDetail.name" @error="handleActorAvatarError($event)">
                        <svg v-else class="avatar-placeholder" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                    </div>
                    <div class="actor-info-section">
                        <h2 class="actor-name">[[ actorDetail.name ]]</h2>
                        <div class="actor-stats">
                            <div class="stat-item">
                                <span class="stat-label">å½±ç‰‡</span>
                                <span class="stat-value">[[ actorDetail.movie_count ]] éƒ¨</span>
                            </div>
                            <div class="stat-item" v-if="actorDetail.last_updated">
                                <span class="stat-label">RSSæ›´æ–°</span>
                                <span class="stat-value">[[ formatDate(actorDetail.last_updated) ]]</span>
                            </div>
                        </div>
                        <div class="javbus-config">
                            <label>JAVBus ID:</label>
                            <input
                                type="text"
                                v-model="actorDetail.javbus_id"
                                placeholder="è¾“å…¥JAVBus ID"
                                class="javbus-input-large"
                            >
                            <button @click="saveActorJavbusId" class="rss-refresh-small save-btn">
                                ğŸ’¾ ä¿å­˜
                            </button>
                            <button v-if="actorDetail.javbus_id" @click="refreshActorRss" :disabled="rssRefreshing" class="rss-refresh-small">
                                [[ rssRefreshing ? 'åˆ·æ–°ä¸­' : 'ğŸ”„ åˆ·æ–°' ]]
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Tabs for Actor Detail -->
                <div class="actor-tabs">
                    <button
                        :class="['actor-tab', { active: actorSubTab === 'movies' }]"
                        @click="actorSubTab = 'movies'"
                    >
                        å…¨éƒ¨å½±ç‰‡
                    </button>
                    <button
                        :class="['actor-tab', { active: actorSubTab === 'rss' }]"
                        @click="actorSubTab = 'rss'; loadActorRssItems()"
                    >
                        RSSè®¢é˜… <span v-if="actorRssUnwatched > 0" class="unwatched-badge">[[ actorRssUnwatched ]]</span>
                    </button>
                    <button
                        v-if="actorSubTab === 'movies'"
                        class="actor-javdb-btn"
                        @click="fetchActorJavdbScores"
                        :disabled="javdbFetching"
                    >
                        [[ javdbFetching ? 'è·å–ä¸­...' : 'â­ è·å–JavDBè¯„åˆ†' ]]
                    </button>
                </div>

                <!-- Movies Tab -->
                <div v-if="actorSubTab === 'movies'" class="actor-movies">
                    <div class="movie-grid">
                        <div v-for="movie in actorMovies" :key="movie.code" class="movie-card">
                            <div class="movie-poster">
                                <img v-if="movie.poster_url" :src="movie.poster_url" :alt="movie.title" @error="handlePosterError($event)">
                                <svg v-else class="placeholder-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"/>
                                </svg>
                            </div>
                            <div class="movie-info">
                                <div class="movie-code">[[ movie.code ]]</div>
                                <div class="movie-title" :title="movie.title">[[ movie.title ]]</div>
                                <div class="movie-year">[[ movie.year ]]</div>
                                <div class="movie-score" v-if="movie.score">[[ movie.score ]]åˆ†</div>
                                <div class="movie-javdb-score" v-if="movie.javdb_score" :class="getJavdbScoreClass(movie.javdb_score)">
                                    â­ [[ movie.javdb_score ]]/5
                                </div>
                                <button v-else class="fetch-javdb-btn" @click="fetchJavdbScore(movie)" :disabled="movie.fetching">
                                    [[ movie.fetching ? 'è·å–ä¸­...' : 'è·å–JavDBè¯„åˆ†' ]]
                                </button>
                                <div class="movie-tags">
                                    <span
                                        v-for="tag in movie.all_tags"
                                        :key="tag"
                                        :class="['movie-tag', movie.tags.includes(tag) ? 'active' : 'inactive']"
                                    >
                                        [[ getShortTag(tag) ]]
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div v-if="actorMovies.length === 0" class="empty">æš‚æ— å½±ç‰‡</div>
                </div>

                <!-- RSS Tab -->
                <div v-if="actorSubTab === 'rss'" class="actor-rss-list">
                    <div class="rss-actions" v-if="actorRssItems.length > 0">
                        <button @click="markActorWatched(actorDetail.actor_id)" class="watched-btn">
                            âœ“ ä¸€é”®å·²é˜…
                        </button>
                    </div>
                    <div v-if="actorRssItems.length === 0" class="empty">æš‚æ— RSSè®¢é˜…æ•°æ®</div>
                    <div v-for="item in actorRssItems" :key="item.id" :class="['rss-item', { watched: item.is_watched }]">
                        <input
                            type="checkbox"
                            :checked="item.is_watched"
                            @change="toggleWatch(item.id, $event.target.checked)"
                            class="rss-checkbox"
                        >
                        <div class="rss-item-content">
                            <div class="rss-item-header">
                                <a :href="item.javbus_url" target="_blank" class="rss-code">[[ item.code ]]</a>
                                <span class="rss-score" :title="'æƒé‡åˆ†: ' + item.score">[[ item.score ]]åˆ†</span>
                            </div>
                            <div class="rss-item-title" :title="item.title">[[ item.title ]]</div>
                            <div class="rss-item-date">[[ item.pub_date ]]</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RSS Subscription View -->
            <div v-else-if="currentTab === 'rss'" class="rss-view">
                <div class="rss-header">
                    <div class="section-title">RSS è®¢é˜…</div>
                    <div class="rss-actions">
                        <button @click="refreshRss" :disabled="rssRefreshing" class="rss-refresh-btn">
                            [[ rssRefreshing ? 'åˆ·æ–°ä¸­...' : 'ğŸ”„ åˆ·æ–°å…¨éƒ¨' ]]
                        </button>
                        <button @click="markAllWatched" :disabled="rssItems.length === 0" class="watched-btn">
                            âœ“ ä¸€é”®å·²é˜…
                        </button>
                    </div>
                </div>

                <!-- View Toggle -->
                <div class="rss-view-toggle">
                    <button :class="['toggle-btn', { active: rssViewMode === 'all' }]" @click="rssViewMode = 'all'">
                        æ€»åˆ—è¡¨
                    </button>
                    <button :class="['toggle-btn', { active: rssViewMode === 'by_actor' }]" @click="rssViewMode = 'by_actor'">
                        æŒ‰æ¼”å‘˜
                    </button>
                </div>

                <!-- RSS Items List (All Mode) -->
                <div v-if="rssViewMode === 'all'" class="rss-list">
                    <div v-if="rssItems.length === 0" class="empty">æš‚æ— è®¢é˜…æ•°æ®</div>
                    <div v-for="item in rssItems" :key="item.id" :class="['rss-item', { watched: item.is_watched }]">
                        <input
                            type="checkbox"
                            :checked="item.is_watched"
                            @change="toggleWatch(item.id, $event.target.checked)"
                            class="rss-checkbox"
                        >
                        <div class="rss-item-content">
                            <div class="rss-item-header">
                                <a :href="item.javbus_url" target="_blank" class="rss-code">[[ item.code ]]</a>
                                <span class="rss-score" :title="'æƒé‡åˆ†: ' + item.score">[[ item.score ]]åˆ†</span>
                                <span class="rss-actor">[[ item.actor_name ]]</span>
                            </div>
                            <div class="rss-item-title" :title="item.title">[[ item.title ]]</div>
                            <div class="rss-item-date">[[ item.pub_date ]]</div>
                        </div>
                    </div>
                </div>

                <!-- RSS Items List (By Actor Mode) -->
                <div v-else class="rss-by-actor">
                    <div v-for="(items, actorName) in rssItemsByActor" :key="actorName" class="actor-rss-group">
                        <h3 class="actor-rss-title">
                            <span class="collapse-toggle" @click="collapsedActors[actorName] = !collapsedActors[actorName]">
                                [[ collapsedActors[actorName] ? 'â–¶' : 'â–¼' ]]
                            </span>
                            [[ actorName ]] ([[ items.length ]] éƒ¨)
                            <button @click="markActorWatched(items[0].actor_id)" class="small-watched-btn">
                                ä¸€é”®å·²é˜…
                            </button>
                        </h3>
                        <div v-show="!collapsedActors[actorName]" class="rss-list">
                            <div v-for="item in items" :key="item.id" :class="['rss-item', { watched: item.is_watched }]">
                                <input
                                    type="checkbox"
                                    :checked="item.is_watched"
                                    @change="toggleWatch(item.id, $event.target.checked)"
                                    class="rss-checkbox"
                                >
                                <div class="rss-item-content">
                                    <div class="rss-item-header">
                                        <a :href="item.javbus_url" target="_blank" class="rss-code">[[ item.code ]]</a>
                                        <span class="rss-score" :title="'æƒé‡åˆ†: ' + item.score">[[ item.score ]]åˆ†</span>
                                    </div>
                                    <div class="rss-item-title" :title="item.title">[[ item.title ]]</div>
                                    <div class="rss-item-date">[[ item.pub_date ]]</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div v-if="Object.keys(rssItemsByActor).length === 0" class="empty">æš‚æ— è®¢é˜…æ•°æ®</div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const { createApp, ref, onMounted, watch } = Vue;

        const app = createApp({
            setup() {
                const currentTab = ref('all');
                const movies = ref([]);
                const listMovies = ref([]);
                const missing = ref({ javdb: [], javlib: [], both: [] });
                const actors = ref([]);
                const actorMovies = ref([]);
                const currentActorName = ref('');
                const search = ref('');
                const sortBy = ref('code');
                const syncing = ref(false);
                const calculating = ref(false);
                const javdbFetching = ref(false);
                const stats = ref({ total: 0, javdb_count: 0, javlib_count: 0 });

                // RSS
                const rssItems = ref([]);
                const rssItemsByActor = ref({});
                const rssViewMode = ref('all');
                const rssRefreshing = ref(false);

                // RSS Notification state
                const rssNotification = ref({
                    show: false,
                    type: 'rss',  // 'rss' or 'javdb'
                    success: 0,
                    fail: 0,
                    message: ''
                });
                const rssDetailsModal = ref({
                    show: false,
                    summary: null,
                    results: []
                });
                let rssStatusPollInterval = null;
                const rssActors = ref({});  // {name: {javbus_id, id}}
                const currentRssActorId = ref(null);
                const collapsedActors = ref({});  // Track collapsed state for each actor

                // Actor detail page
                const actorDetail = ref({
                    name: '',
                    javbus_id: '',
                    rss_url: '',
                    last_updated: '',
                    movie_count: 0,
                    avatar_url: '',
                    actor_id: null
                });
                const actorSubTab = ref('movies');
                const actorRssItems = ref([]);
                const actorRssUnwatched = ref(0);

                // Pagination
                const currentPage = ref(1);
                const pageSize = ref(50);
                const totalPages = ref(1);
                const totalItems = ref(0);

                const tabs = [
                    { id: 'all', name: 'å…¨éƒ¨', icon: 'ğŸ“š' },
                    { id: 'actors', name: 'æ¼”å‘˜', icon: 'ğŸ‘¤' },
                    { id: 'rss', name: 'RSSè®¢é˜…', icon: 'ğŸ“¡' },
                    { id: 'javdb', name: 'JavDB TOP250', icon: 'ğŸ†' },
                    { id: 'javdb_2025', name: 'JavDB 2025', icon: 'ğŸ†' },
                    { id: 'javdb_2024', name: 'JavDB 2024', icon: 'ğŸ†' },
                    { id: 'javdb_2023', name: 'JavDB 2023', icon: 'ğŸ†' },
                    { id: 'javlib', name: 'JavLibray TOP500', icon: 'ğŸ†' },
                    { id: 'missing', name: 'æœªæ”¶å½•', icon: 'âŒ' }
                ];

                const getShortTag = (tag) => {
                    const map = {
                        'JavDB TOP250': 'DB',
                        'JavDB 2025 TOP250': 'DB25',
                        'JavDB 2024 TOP250': 'DB24',
                        'JavDB 2023 TOP250': 'DB23',
                        'JavLibray TOP500': 'JL'
                    };
                    return map[tag] || tag;
                };

                // Handle poster image load error - show placeholder
                const handlePosterError = (event) => {
                    event.target.style.display = 'none';
                    const placeholder = event.target.nextElementSibling;
                    if (placeholder) {
                        placeholder.style.display = 'block';
                    }
                };

                const getTabTitle = (tabId) => {
                    const tab = tabs.find(t => t.id === tabId);
                    return tab ? tab.name : '';
                };

                const sortMovies = (list) => {
                    if (sortBy.value === 'year_desc') {
                        return [...list].sort((a, b) => (b.year || '').localeCompare(a.year || ''));
                    } else if (sortBy.value === 'year_asc') {
                        return [...list].sort((a, b) => (a.year || '').localeCompare(b.year || ''));
                    } else if (sortBy.value === 'score_desc') {
                        return [...list].sort((a, b) => (b.score || 0) - (a.score || 0));
                    } else if (sortBy.value === 'score_asc') {
                        return [...list].sort((a, b) => (a.score || 0) - (b.score || 0));
                    }
                    return list;
                };

                const loadMovies = async () => {
                    const res = await axios.get('/api/movies', {
                        params: {
                            search: search.value,
                            page: currentPage.value,
                            page_size: pageSize.value
                        }
                    });
                    // Add fetching flag to each movie
                    const data = res.data.data.map(m => ({ ...m, fetching: false }));
                    movies.value = sortMovies(data);
                    totalPages.value = res.data.total_pages;
                    totalItems.value = res.data.total;
                };

                const handleSearch = () => {
                    currentPage.value = 1;
                    if (currentTab.value === 'all') {
                        loadMovies();
                    } else if (currentTab.value.startsWith('actor_')) {
                        sortActorMovies();
                    }
                };

                const sortActorMovies = () => {
                    actorMovies.value = sortMovies(actorMovies.value);
                };

                const loadList = async (listName) => {
                    let apiName = listName;
                    if (listName === 'javdb') apiName = 'JavDB TOP250';
                    if (listName === 'javdb_2025') apiName = 'JavDB 2025 TOP250';
                    if (listName === 'javdb_2024') apiName = 'JavDB 2024 TOP250';
                    if (listName === 'javdb_2023') apiName = 'JavDB 2023 TOP250';
                    if (listName === 'javlib') apiName = 'JavLibray TOP500';

                    const res = await axios.get(`/api/list/${encodeURIComponent(apiName)}`, {
                        params: {
                            page: currentPage.value,
                            page_size: pageSize.value
                        }
                    });
                    listMovies.value = res.data.data;
                    totalPages.value = res.data.total_pages;
                    totalItems.value = res.data.total;
                };

                const loadMissing = async () => {
                    const res = await axios.get('/api/list/missing');
                    missing.value = res.data;
                };

                const loadActors = async () => {
                    const res = await axios.get('/api/actors');
                    actors.value = res.data;
                };

                const showActorMovies = async (actorName) => {
                    currentActorName.value = actorName;
                    const res = await axios.get(`/api/actor/${encodeURIComponent(actorName)}`);
                    const data = res.data.map(m => ({ ...m, fetching: false }));
                    actorMovies.value = sortMovies(data);
                    currentTab.value = 'actor_' + encodeURIComponent(actorName);
                };

                const showActorDetail = async (actorName) => {
                    currentActorName.value = actorName;
                    actorSubTab.value = 'movies';

                    // Load actor detail
                    const detailRes = await axios.get(`/api/actor/${encodeURIComponent(actorName)}/detail`);
                    actorDetail.value = detailRes.data;

                    // Load actor movies
                    const moviesRes = await axios.get(`/api/actor/${encodeURIComponent(actorName)}`);
                    const data = moviesRes.data.map(m => ({ ...m, fetching: false }));
                    actorMovies.value = sortMovies(data);

                    currentTab.value = 'actor_' + encodeURIComponent(actorName);
                };

                const saveActorJavbusId = async () => {
                    if (!actorDetail.value.actor_id) return;

                    await axios.put(`/api/rss/actors/${actorDetail.value.actor_id}`, {
                        javbus_id: actorDetail.value.javbus_id
                    });
                };

                const refreshActorRss = async () => {
                    if (!actorDetail.value.actor_id) return;

                    rssRefreshing.value = true;
                    try {
                        // Only refresh current actor's RSS
                        await axios.post(`/api/rss/refresh/${actorDetail.value.actor_id}`);
                        // Reload actor detail to get updated last_updated
                        const detailRes = await axios.get(`/api/actor/${encodeURIComponent(actorDetail.value.name)}/detail`);
                        actorDetail.value = detailRes.data;

                        // Reload RSS items if on RSS tab
                        if (actorSubTab.value === 'rss') {
                            await loadActorRssItems();
                        }
                    } finally {
                        rssRefreshing.value = false;
                    }
                };

                const fetchActorJavdbScores = async () => {
                    if (!actorDetail.value.name) return;

                    javdbFetching.value = true;
                    try {
                        const res = await axios.post(`/api/actor/${encodeURIComponent(actorDetail.value.name)}/fetch_javdb_scores`);
                        if (res.data.success) {
                            // Show notification
                            rssNotification.value = {
                                show: true,
                                type: 'javdb',
                                success: res.data.success_count,
                                fail: res.data.fail_count,
                                message: `JavDBè¯„åˆ†è·å–å®Œæˆï¼æˆåŠŸ: ${res.data.success_count}, å¤±è´¥: ${res.data.fail_count}`
                            };
                            // Reload actor movies
                            const moviesRes = await axios.get(`/api/actor/${encodeURIComponent(actorDetail.value.name)}`);
                            const data = moviesRes.data.map(m => ({ ...m, fetching: false }));
                            actorMovies.value = sortMovies(data);
                        }
                    } catch (e) {
                        console.error('è·å–JavDBè¯„åˆ†å¤±è´¥:', e);
                    } finally {
                        javdbFetching.value = false;
                    }
                };

                const loadActorRssItems = async () => {
                    if (!actorDetail.value.actor_id) return;

                    const res = await axios.get('/api/rss/items', {
                        params: { actor_id: actorDetail.value.actor_id }
                    });
                    actorRssItems.value = res.data;
                    actorRssUnwatched.value = res.data.filter(item => !item.is_watched).length;
                };

                const formatDate = (dateStr) => {
                    if (!dateStr) return '-';
                    try {
                        const date = new Date(dateStr);
                        return date.toLocaleDateString('zh-CN');
                    } catch {
                        return dateStr;
                    }
                };

                const handleActorAvatarError = (event) => {
                    event.target.style.display = 'none';
                    const placeholder = event.target.nextElementSibling;
                    if (placeholder) {
                        placeholder.style.display = 'block';
                    }
                };

                const loadStats = async () => {
                    const res = await axios.get('/api/stats');
                    stats.value = res.data;
                };

                const loadRssItems = async () => {
                    const view = rssViewMode.value;
                    const params = { view };
                    if (currentRssActorId.value) {
                        params.actor_id = currentRssActorId.value;
                    }
                    const res = await axios.get('/api/rss/items', { params });
                    if (view === 'by_actor') {
                        rssItemsByActor.value = res.data;
                    } else {
                        rssItems.value = res.data;
                    }
                };

                const refreshRss = async () => {
                    rssRefreshing.value = true;
                    try {
                        // Use background refresh (non-blocking)
                        const res = await axios.post('/api/rss/refresh');
                        if (res.data.success) {
                            // Start polling for status
                            startRssStatusPolling();
                        } else if (res.data.is_running) {
                            // Already running, just poll status
                            startRssStatusPolling();
                        }
                    } catch (e) {
                        console.error('RSS refresh error:', e);
                        rssRefreshing.value = false;
                    }
                };

                // Poll RSS status until complete
                const startRssStatusPolling = () => {
                    if (rssStatusPollInterval) {
                        clearInterval(rssStatusPollInterval);
                    }
                    rssStatusPollInterval = setInterval(async () => {
                        try {
                            const res = await axios.get('/api/rss/status');
                            if (res.data.is_complete) {
                                clearInterval(rssStatusPollInterval);
                                rssStatusPollInterval = null;
                                rssRefreshing.value = false;

                                // Show notification
                                if (res.data.summary) {
                                    rssNotification.value = {
                                        show: true,
                                        success: res.data.summary.success,
                                        fail: res.data.summary.fail
                                    };
                                    // Auto-dismiss after 10 seconds
                                    setTimeout(() => {
                                        rssNotification.value.show = false;
                                    }, 10000);
                                }

                                // Reload RSS items
                                await loadRssItems();
                            }
                        } catch (e) {
                            console.error('RSS status poll error:', e);
                        }
                    }, 2000);
                };

                // Show RSS details modal
                const showRssDetails = async () => {
                    rssNotification.value.show = false;
                    try {
                        const res = await axios.get('/api/rss/status');
                        rssDetailsModal.value = {
                            show: true,
                            summary: res.data.summary,
                            results: res.data.results
                        };
                    } catch (e) {
                        console.error('Failed to load RSS details:', e);
                    }
                };

                // Show notification details (RSS or JavDB)
                const showNotificationDetails = async () => {
                    if (rssNotification.value.type === 'javdb') {
                        // Show JavDB details
                        rssNotification.value.show = false;
                        try {
                            const res = await axios.get('/api/javdb_task_status');
                            rssDetailsModal.value = {
                                show: true,
                                title: 'JavDB è¯„åˆ†è¯¦æƒ…',
                                summary: res.data.summary,
                                results: res.data.results || []
                            };
                        } catch (e) {
                            console.error('Failed to load JavDB details:', e);
                        }
                    } else {
                        // Show RSS details
                        showRssDetails();
                    }
                };

                // Dismiss RSS notification
                const dismissRssNotification = () => {
                    rssNotification.value.show = false;
                };

                const toggleWatch = async (itemId, isWatched) => {
                    await axios.post(`/api/rss/items/${itemId}/watch`, { is_watched: isWatched });
                    await loadRssItems();
                };

                const markAllWatched = async () => {
                    await axios.post('/api/rss/items/watch', {});
                    await loadRssItems();
                };

                const markActorWatched = async (actorId) => {
                    await axios.post('/api/rss/items/watch', { actor_id: actorId });
                    await loadRssItems();
                };

                const loadRssActors = async () => {
                    const res = await axios.get('/api/rss/actors');
                    const actorsMap = {};
                    for (const actor of res.data) {
                        actorsMap[actor.name] = {
                            javbus_id: actor.javbus_id,
                            id: actor.id,
                            has_rss: actor.has_rss
                        };
                    }
                    rssActors.value = actorsMap;
                };

                const updateActorJavbusId = async (actorName, javbusId) => {
                    // Find or create the actor in the database
                    let actorData = rssActors.value[actorName];
                    if (!actorData) {
                        // Create the actor first
                        await axios.post('/api/rss/actors', { name: actorName });
                        await loadRssActors();
                        actorData = rssActors.value[actorName];
                    }

                    if (actorData && actorData.id) {
                        await axios.put(`/api/rss/actors/${actorData.id}`, { javbus_id: javbusId });
                        await loadRssActors();
                    }
                };

                const showActorRss = async (actorName) => {
                    const actorData = rssActors.value[actorName];
                    if (actorData && actorData.id) {
                        currentRssActorId.value = actorData.id;
                        currentTab.value = 'rss';
                        await loadRssItems();
                    }
                };

                const sync = async () => {
                    syncing.value = true;
                    try {
                        await axios.post('/api/sync');
                        await loadMovies();
                        await loadStats();
                        await switchTab(currentTab.value);
                    } finally {
                        syncing.value = false;
                    }
                };

                const calcScores = async () => {
                    calculating.value = true;
                    try {
                        await axios.post('/api/calc_scores');
                        await loadMovies();
                        alert('æƒé‡åˆ†è®¡ç®—å®Œæˆï¼');
                    } finally {
                        calculating.value = false;
                    }
                };

                const getJavdbScoreClass = (score) => {
                    if (score >= 4) return 'score-high';
                    if (score >= 3) return 'score-mid';
                    return 'score-low';
                };

                const fetchJavdbScore = async (movie) => {
                    console.log('Fetching JavDB score for:', movie.code);
                    movie.fetching = true;
                    javdbFetching.value = true;
                    try {
                        const encodedCode = encodeURIComponent(movie.code);
                        console.log('API URL:', `/api/test_javdb/${encodedCode}`);
                        const res = await axios.get(`/api/test_javdb/${encodedCode}`);
                        console.log('API Response:', res.data);
                        // Start polling for status
                        pollJavdbSingleStatus(movie);
                    } catch (e) {
                        console.error('è·å–JavDBè¯„åˆ†å¤±è´¥:', e);
                        javdbFetching.value = false;
                        movie.fetching = false;
                    }
                };

                const pollJavdbSingleStatus = (movie) => {
                    let pollCount = 0;
                    const pollInterval = setInterval(async () => {
                        pollCount++;
                        try {
                            const res = await axios.get('/api/javdb_task_status');
                            console.log('Poll', pollCount, 'Movie code:', movie.code, 'Results:', res.data.results);
                            const results = res.data.results || [];
                            // Find the latest result for this movie code
                            const myResult = results.reverse().find(r => r.code === movie.code);
                            console.log('Looking for:', movie.code, 'Found result:', myResult);

                            if (myResult && myResult.status !== 'running') {
                                clearInterval(pollInterval);
                                javdbFetching.value = false;
                                movie.fetching = false;

                                if (myResult.status === 'success') {
                                    movie.javdb_score = myResult.score;
                                    // Show JavDB notification
                                    rssNotification.value = {
                                        show: true,
                                        type: 'javdb',
                                        success: 1,
                                        fail: 0,
                                        message: `JavDBè¯„åˆ†è·å–æˆåŠŸ: ${movie.code} - ${myResult.score}/5`
                                    };
                                } else if (myResult.status === 'not_found') {
                                    rssNotification.value = {
                                        show: true,
                                        type: 'javdb',
                                        success: 0,
                                        fail: 1,
                                        message: `æœªæ‰¾åˆ°å½±ç‰‡: ${movie.code}`
                                    };
                                } else {
                                    rssNotification.value = {
                                        show: true,
                                        type: 'javdb',
                                        success: 0,
                                        fail: 1,
                                        message: `è·å–å¤±è´¥: ${movie.code}`
                                    };
                                }
                                // Reload to update all movies
                                await loadMovies();
                            } else if (pollCount > 10) {
                                // Timeout after 10 seconds
                                clearInterval(pollInterval);
                                javdbFetching.value = false;
                                movie.fetching = false;
                                console.log('Poll timeout for:', movie.code);
                            }
                        } catch (e) {
                            console.error('JavDB status poll error:', e);
                            clearInterval(pollInterval);
                            javdbFetching.value = false;
                            movie.fetching = false;
                        }
                    }, 1000);
                };

                const fetchJavdbScores = async () => {
                    javdbFetching.value = true;
                    try {
                        const res = await axios.post('/api/fetch_javdb_scores');
                        if (res.data.success) {
                            // Start polling for status
                            pollJavdbStatus();
                        }
                    } catch (e) {
                        console.error('JavDB fetch error:', e);
                        javdbFetching.value = false;
                    }
                };

                const pollJavdbStatus = () => {
                    const pollInterval = setInterval(async () => {
                        try {
                            const res = await axios.get('/api/javdb_task_status');
                            if (res.data.is_complete) {
                                clearInterval(pollInterval);
                                javdbFetching.value = false;
                                await loadMovies();
                                if (res.data.summary) {
                                    rssNotification.value = {
                                        show: true,
                                        type: 'javdb',
                                        success: res.data.summary.success,
                                        fail: res.data.summary.fail,
                                        message: `JavDB è¯„åˆ†è·å–å®Œæˆï¼æˆåŠŸ: ${res.data.summary.success}, å¤±è´¥: ${res.data.summary.fail}`
                                    };
                                }
                            }
                        } catch (e) {
                            console.error('JavDB status poll error:', e);
                        }
                    }, 2000);
                };

                const switchTab = async (tabId) => {
                    currentTab.value = tabId;
                    currentPage.value = 1;
                    if (tabId === 'all') {
                        await loadMovies();
                    } else if (tabId === 'missing') {
                        await loadMissing();
                    } else if (tabId === 'actors') {
                        await loadActors();
                        await loadRssActors();
                    } else if (tabId === 'rss') {
                        await loadRssItems();
                    } else if (tabId.startsWith('actor_')) {
                        const actorName = decodeURIComponent(tabId.substring(7));
                        currentActorName.value = actorName;
                        // Load actor detail
                        const detailRes = await axios.get(`/api/actor/${encodeURIComponent(actorName)}/detail`);
                        actorDetail.value = detailRes.data;
                        // Load actor movies
                        const res = await axios.get(`/api/actor/${encodeURIComponent(actorName)}`);
                        const data = res.data.map(m => ({ ...m, fetching: false }));
                        actorMovies.value = sortMovies(data);
                        actorSubTab.value = 'movies';
                    } else {
                        await loadList(tabId);
                    }
                };

                const goToPage = async (page) => {
                    if (page < 1 || page > totalPages.value) return;
                    currentPage.value = page;
                    if (currentTab.value === 'all') {
                        await loadMovies();
                    } else if (currentTab.value.startsWith('javdb') || currentTab.value === 'javlib') {
                        await loadList(currentTab.value);
                    }
                };

                const changePageSize = async (size) => {
                    pageSize.value = size;
                    currentPage.value = 1;
                    if (currentTab.value === 'all') {
                        await loadMovies();
                    } else if (currentTab.value.startsWith('javdb') || currentTab.value === 'javlib') {
                        await loadList(currentTab.value);
                    }
                };

                onMounted(async () => {
                    await loadStats();
                    await switchTab('all');

                    // Check if RSS update is running or recently completed
                    try {
                        const statusRes = await axios.get('/api/rss/status');
                        if (statusRes.data.is_running) {
                            // Already running, start polling
                            rssRefreshing.value = true;
                            startRssStatusPolling();
                        } else if (statusRes.data.is_complete && statusRes.data.summary) {
                            // Recently completed, show notification if there are results
                            if (statusRes.data.summary.total > 0) {
                                rssNotification.value = {
                                    show: true,
                                    success: statusRes.data.summary.success,
                                    fail: statusRes.data.summary.fail
                                };
                                // Auto-dismiss after 8 seconds
                                setTimeout(() => {
                                    rssNotification.value.show = false;
                                }, 8000);
                            }
                        }
                    } catch (e) {
                        console.error('Failed to check RSS status:', e);
                    }
                });

                // Watch for RSS view mode changes
                watch(rssViewMode, async () => {
                    if (currentTab.value === 'rss') {
                        await loadRssItems();
                    }
                });

                return {
                    currentTab,
                    movies,
                    listMovies,
                    missing,
                    actors,
                    actorMovies,
                    currentActorName,
                    search,
                    sortBy,
                    syncing,
                    calculating,
                    javdbFetching,
                    stats,
                    tabs,
                    currentPage,
                    pageSize,
                    totalPages,
                    totalItems,
                    // RSS
                    rssItems,
                    rssItemsByActor,
                    rssViewMode,
                    rssRefreshing,
                    rssNotification,
                    rssDetailsModal,
                    rssActors,
                    currentRssActorId,
                    collapsedActors,
                    // Actor detail
                    actorDetail,
                    actorSubTab,
                    actorRssItems,
                    actorRssUnwatched,
                    getShortTag,
                    getTabTitle,
                    loadMovies,
                    handleSearch,
                    loadActors,
                    showActorMovies,
                    showActorDetail,
                    sync,
                    calcScores,
                    getJavdbScoreClass,
                    fetchJavdbScore,
                    fetchJavdbScores,
                    switchTab,
                    goToPage,
                    changePageSize,
                    handlePosterError,
                    loadRssItems,
                    refreshRss,
                    showRssDetails,
                    showNotificationDetails,
                    dismissRssNotification,
                    toggleWatch,
                    markAllWatched,
                    markActorWatched,
                    loadRssActors,
                    updateActorJavbusId,
                    showActorRss,
                    saveActorJavbusId,
                    refreshActorRss,
                    fetchActorJavdbScores,
                    loadActorRssItems,
                    formatDate,
                    handleActorAvatarError
                };
            }
        });

        app.config.compilerOptions.delimiters = ['[[', ']]'];
        app.mount('#app');
    </script>
</body>
</html>
